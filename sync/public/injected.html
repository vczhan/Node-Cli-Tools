<!-- inject code -->
<script>
if ('WebSocket' in window) {
  (function () {
    function refreshCSS() {
      const sheets = document.querySelectorAll('link')
      const head = document.head

      for (let i = 0, elem; elem = sheets[i++];) {
        const parent = elem.parentElement || head
        parent.removeChild(elem)
        parent.appendChild(elem)
      }
    }

    const address = 'ws://' + location.host + '/ws'
    const socket = new WebSocket(address)

    socket.onmessage = msg => {
      if (msg.data === 'reload') location.reload()
      else if (msg.data === 'refreshcss') refreshCSS()
    }
  })()
}
</script>
